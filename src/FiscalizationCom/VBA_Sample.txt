Public Function SendInvoiceTest()

    ' .NET COM Interop
    Dim cisInterop As New FiscalizationComInterop
    
    ' Demo OIB & certificate
    Dim d As New Demo
    
    ' Create invoice number
    Dim invoiceNr As New BrojRacunaType
    With invoiceNr
        .BrOznRac = "1"
        .OznPosPr = "1"
        .OznNapUr = "1"
    End With
    
    ' Create Racun
    Dim invoice As New RacunType
    With invoice
        .OIB = d.OIB
        .USustPdv = True
        .IznosUkupno = "123.45"
        .DatVrijeme = cisInterop.DateFormatLong(DateTime.Now)
        .OznSlijed = OznakaSlijednostiType.OznakaSlijednostiType_N
        .NacinPlac = NacinPlacanjaType.NacinPlacanjaType_G
        .OibOper = "98642375382"
        .NakDost = False
        .BrRac = invoiceNr
    End With
    
    'Call cisInterop.GenerateZki(invoice, d.CERT)
    ' invoice.ZastKod <- filled with generated ZKI code
    
    Dim request As RacunZahtjev
    Set request = cisInterop.CreateInvoiceRequest(invoice)
    
    'Call cisInterop.Sign(request, d.CERT)
    ' call GenerateZki and Sign request
    
    ' Send request
    Dim result As RacunOdgovor
    Set result = cisInterop.SendInvoiceRequest(request, d.CERT, 0, True)
    
    MsgBox (result.Jir)
    
End Function
